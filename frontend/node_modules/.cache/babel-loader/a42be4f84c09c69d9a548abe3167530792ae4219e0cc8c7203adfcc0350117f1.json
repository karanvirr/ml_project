{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ShopperView=()=>{const[query,setQuery]=useState('');const[chatHistory,setChatHistory]=useState([{sender:'bot',text:\"Hi! I'm your AI shopping assistant. Looking for something specific?\"}]);const[loading,setLoading]=useState(false);const chatEndRef=useRef(null);const scrollToBottom=()=>{var _chatEndRef$current;(_chatEndRef$current=chatEndRef.current)===null||_chatEndRef$current===void 0?void 0:_chatEndRef$current.scrollIntoView({behavior:\"smooth\"});};useEffect(()=>{scrollToBottom();},[chatHistory]);const handleSend=async()=>{if(!query.trim())return;const userMsg={sender:'user',text:query};setChatHistory(prev=>[...prev,userMsg]);setQuery('');setLoading(true);try{const res=await axios.post('/chat/query',{user_id:'guest',text:userMsg.text});const botMsg={sender:'bot',text:res.data.response_text,data:res.data.data,action:res.data.action};setChatHistory(prev=>[...prev,botMsg]);}catch(error){console.error(\"Error sending message:\",error);setChatHistory(prev=>[...prev,{sender:'bot',text:\"Sorry, I'm having trouble connecting right now.\"}]);}setLoading(false);};const handleKeyPress=e=>{if(e.key==='Enter')handleSend();};return/*#__PURE__*/_jsxs(\"div\",{className:\"glass-card\",style:{height:'80vh',display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-window\",style:{flex:1,overflowY:'auto',padding:'1rem',display:'flex',flexDirection:'column',gap:'1rem'},children:[chatHistory.map((msg,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:`message ${msg.sender}`,style:{alignSelf:msg.sender==='user'?'flex-end':'flex-start',maxWidth:'80%',padding:'12px 16px',borderRadius:'16px',borderBottomRightRadius:msg.sender==='user'?'4px':'16px',borderBottomLeftRadius:msg.sender==='bot'?'4px':'16px',background:msg.sender==='user'?'var(--primary)':'rgba(255,255,255,0.1)',color:'white',boxShadow:'0 2px 8px rgba(0,0,0,0.1)'},children:[/*#__PURE__*/_jsx(\"p\",{style:{margin:0},children:msg.text}),msg.data&&Array.isArray(msg.data)&&msg.data.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"product-grid\",style:{display:'grid',gridTemplateColumns:'repeat(auto-fill, minmax(150px, 1fr))',gap:'10px',marginTop:'10px'},children:msg.data.map((item,i)=>/*#__PURE__*/_jsxs(\"div\",{style:{background:'rgba(0,0,0,0.3)',padding:'10px',borderRadius:'8px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{height:'80px',background:'#334155',borderRadius:'6px',marginBottom:'8px'}}),/*#__PURE__*/_jsx(\"strong\",{style:{display:'block',fontSize:'0.9rem'},children:item.name}),/*#__PURE__*/_jsxs(\"span\",{style:{color:'var(--accent)',fontSize:'0.85rem'},children:[\"\\u20B9\",item.price]})]},i))})]},idx)),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"message bot\",style:{alignSelf:'flex-start',background:'rgba(255,255,255,0.1)',padding:'12px',borderRadius:'16px'},children:/*#__PURE__*/_jsx(\"span\",{className:\"typing-dot\",children:\"...\"})}),/*#__PURE__*/_jsx(\"div\",{ref:chatEndRef})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-area\",style:{display:'flex',gap:'10px',paddingTop:'1rem',borderTop:'1px solid var(--border-color)'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"input-field\",value:query,onChange:e=>setQuery(e.target.value),onKeyPress:handleKeyPress,placeholder:\"Ask for products, stores, or recommendations...\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:handleSend,children:\"Send\"})]})]});};export default ShopperView;","map":{"version":3,"names":["React","useState","useRef","useEffect","axios","jsx","_jsx","jsxs","_jsxs","ShopperView","query","setQuery","chatHistory","setChatHistory","sender","text","loading","setLoading","chatEndRef","scrollToBottom","_chatEndRef$current","current","scrollIntoView","behavior","handleSend","trim","userMsg","prev","res","post","user_id","botMsg","data","response_text","action","error","console","handleKeyPress","e","key","className","style","height","display","flexDirection","children","flex","overflowY","padding","gap","map","msg","idx","alignSelf","maxWidth","borderRadius","borderBottomRightRadius","borderBottomLeftRadius","background","color","boxShadow","margin","Array","isArray","length","gridTemplateColumns","marginTop","item","i","marginBottom","fontSize","name","price","ref","paddingTop","borderTop","type","value","onChange","target","onKeyPress","placeholder","onClick"],"sources":["C:/Users/Karanvir Singh/Desktop/ai mall project/frontend/src/components/ShopperView.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst ShopperView = () => {\r\n  const [query, setQuery] = useState('');\r\n  const [chatHistory, setChatHistory] = useState([\r\n    { sender: 'bot', text: \"Hi! I'm your AI shopping assistant. Looking for something specific?\" }\r\n  ]);\r\n  const [loading, setLoading] = useState(false);\r\n  const chatEndRef = useRef(null);\r\n\r\n  const scrollToBottom = () => {\r\n    chatEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [chatHistory]);\r\n\r\n  const handleSend = async () => {\r\n    if (!query.trim()) return;\r\n\r\n    const userMsg = { sender: 'user', text: query };\r\n    setChatHistory(prev => [...prev, userMsg]);\r\n    setQuery('');\r\n    setLoading(true);\r\n\r\n    try {\r\n      const res = await axios.post('/chat/query', {\r\n        user_id: 'guest',\r\n        text: userMsg.text\r\n      });\r\n\r\n      const botMsg = {\r\n        sender: 'bot',\r\n        text: res.data.response_text,\r\n        data: res.data.data,\r\n        action: res.data.action\r\n      };\r\n      setChatHistory(prev => [...prev, botMsg]);\r\n    } catch (error) {\r\n      console.error(\"Error sending message:\", error);\r\n      setChatHistory(prev => [...prev, { sender: 'bot', text: \"Sorry, I'm having trouble connecting right now.\" }]);\r\n    }\r\n    setLoading(false);\r\n  };\r\n\r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter') handleSend();\r\n  };\r\n\r\n  return (\r\n    <div className=\"glass-card\" style={{ height: '80vh', display: 'flex', flexDirection: 'column' }}>\r\n      <div className=\"chat-window\" style={{ flex: 1, overflowY: 'auto', padding: '1rem', display: 'flex', flexDirection: 'column', gap: '1rem' }}>\r\n        {chatHistory.map((msg, idx) => (\r\n          <div\r\n            key={idx}\r\n            className={`message ${msg.sender}`}\r\n            style={{\r\n              alignSelf: msg.sender === 'user' ? 'flex-end' : 'flex-start',\r\n              maxWidth: '80%',\r\n              padding: '12px 16px',\r\n              borderRadius: '16px',\r\n              borderBottomRightRadius: msg.sender === 'user' ? '4px' : '16px',\r\n              borderBottomLeftRadius: msg.sender === 'bot' ? '4px' : '16px',\r\n              background: msg.sender === 'user' ? 'var(--primary)' : 'rgba(255,255,255,0.1)',\r\n              color: 'white',\r\n              boxShadow: '0 2px 8px rgba(0,0,0,0.1)'\r\n            }}\r\n          >\r\n            <p style={{ margin: 0 }}>{msg.text}</p>\r\n\r\n            {/* Render Product Cards if available */}\r\n            {msg.data && Array.isArray(msg.data) && msg.data.length > 0 && (\r\n              <div className=\"product-grid\" style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(150px, 1fr))', gap: '10px', marginTop: '10px' }}>\r\n                {msg.data.map((item, i) => (\r\n                  <div key={i} style={{ background: 'rgba(0,0,0,0.3)', padding: '10px', borderRadius: '8px' }}>\r\n                    <div style={{ height: '80px', background: '#334155', borderRadius: '6px', marginBottom: '8px' }}></div>\r\n                    <strong style={{ display: 'block', fontSize: '0.9rem' }}>{item.name}</strong>\r\n                    <span style={{ color: 'var(--accent)', fontSize: '0.85rem' }}>â‚¹{item.price}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n        ))}\r\n        {loading && (\r\n          <div className=\"message bot\" style={{ alignSelf: 'flex-start', background: 'rgba(255,255,255,0.1)', padding: '12px', borderRadius: '16px' }}>\r\n            <span className=\"typing-dot\">...</span>\r\n          </div>\r\n        )}\r\n        <div ref={chatEndRef} />\r\n      </div>\r\n\r\n      <div className=\"input-area\" style={{ display: 'flex', gap: '10px', paddingTop: '1rem', borderTop: '1px solid var(--border-color)' }}>\r\n        <input\r\n          type=\"text\"\r\n          className=\"input-field\"\r\n          value={query}\r\n          onChange={(e) => setQuery(e.target.value)}\r\n          onKeyPress={handleKeyPress}\r\n          placeholder=\"Ask for products, stores, or recommendations...\"\r\n        />\r\n        <button className=\"btn-primary\" onClick={handleSend}>\r\n          Send\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShopperView;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}